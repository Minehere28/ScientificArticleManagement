@model ScientificArticleManagement.Models.Article
@{
    ViewData["Title"] = "Article Details";
}

<style>
    .bg-none {
        background: none !important;
    }

    .font {
        font-family: 'Montserrat', sans-serif;
    }
</style>

<div class="col-12 text-center mt-20 hero-section bg-none pb-5">
    <h2 class="mb-4">Article Details</h2>
</div>

<div class="card shadow border-0 m-5 p-5">
    <div class="row g-0">
        <div class="col-md-12">
            <div class="card-body font">
                <h4 class="card-title">@Model.Title</h4>
                <p class="text-muted">By @Model.Author?.FullName | Submitted: @Model.SubmissionDate.ToString("dd/MM/yyyy")</p>

                <div class="d-flex justify-content-between mb-3">
                    <span class="badge bg-primary">@Model.Topic?.TopicName</span>
                    <span class="badge @(Model.Status == "Approved" ? "bg-success" : Model.Status == "Rejected" ? "bg-danger" : "bg-warning")">
                        @Model.Status
                    </span>
                </div>

                <p><strong>Summary:</strong></p>
                <p style="white-space: pre-line;">@Model.Summary</p>

                <p><strong>Content:</strong></p>
                <div style="white-space: pre-line;">@Model.Content</div>

                <div class="mt-3">
                    <p><strong>Views:</strong> @Model.CurrentView</p>
                    @if (Model.Status == "Approved")
                    {
                        <p><strong>Accepted Date:</strong> @Model.AcceptedDate?.ToString("dd/MM/yyyy")</p>
                    }
                    else if (Model.Status == "Rejected")
                    {
                        <p><strong>Rejected Date:</strong> @Model.DeniedDate?.ToString("dd/MM/yyyy")</p>
                    }
                </div>

                @if (ViewBag.Role == "Admin")
                {
                    <div class="mt-4 d-flex gap-2">
                        @if (Model.Status == "Pending")
                        {
                            <form method="post" asp-action="Approve" asp-route-id="@Model.Id" class="d-inline">
                                <button type="submit" class="btn btn-success">✅ Approve</button>
                            </form>
                            <form method="post" asp-action="Reject" asp-route-id="@Model.Id" class="d-inline">
                                <button type="submit" class="btn btn-danger">❌ Reject</button>
                            </form>
                        }
                        <a href="@Url.Action("All")" class="btn btn-outline-secondary">Back to List</a>
                    </div>
                }
                else if (ViewBag.Role == "Author")

                {
                    <div class="mt-4 d-flex gap-2">
                        @if (Model.Status == "Pending" && Model.UserId == ViewBag.UserId)
                        {
                            <a href="@Url.Action("Edit", new { id = Model.Id })" class="btn btn-primary">Edit</a>
                            <form method="post" asp-action="Delete" asp-route-id="@Model.Id" class="d-inline">
                                <button type="submit" class="btn vbtn-danger" onclick="return confirm('Are you sure you want to delete this article?')">Delete</button>
                            </form>
                        }
                        <a href="@Url.Action("MyArticles", "Articles")" class="btn btn-outline-secondary">Back to My Articles</a>
                    </div>
                }

                @if (TempData["Success"] != null)
                {
                    <div class="alert alert-success mt-3">@TempData["Success"]</div>
                }
                @if (TempData["Error"] != null)
                {
                    <div class="alert alert-danger mt-3">@TempData["Error"]</div>
                }
            </div>
        </div>
    </div>
</div>